---
layout: post
title:  "Cal Band Computer Committee"
date:   2017-05-18 20:00:00 -0700
categories: experience
img: "compcomm_img.png"
---
# Members Only
Cal Band has a website for logistics, lovingly named, "Members Only." It handles attendance, bus ride logistics, uniform parts, and many other functions. We have over 200 Cal Band members, who all regularly use this website.

The "Computer Committee" maintains and updates the website. As a member, I had to work with a large code base that utilized Django, Sass, and jQuery. Every pull request made had a code review that checked for unnecessary code, bad style, and correctness. From February to April, 5 of my pull requests were merged, with 779 lines of code added. A small example is an improvement in our notification interface. I added two buttons. Our notifications can have links, so one button sends the user to the link, and the text in the button dyanmically changes according to the page that is linked. The other marks the notification as read, so that users can filter through their unread notifications instead of viewing all at the same time.

![Notifications Screenshot]({{ site.url }}/images/compcomm1.png)

# Why not add angry reacts, too?
The largest feature I added was a suggestion box. Previously, the Cal Band suggestion box was a Google Form. Moving the suggestion box to Members Only allows members to still submit suggestions anonymously, but also allows the user to provide contact information via the Members Only User model. Another benefit is that it notifies the leadership whenever a suggestion is submitted. My task was to create two pages: one for members to submit a suggestion, and another for the leadership to view the suggestions.

This leadership page turned out to be a more difficult task than I originally anticipated. After making a page that simply listed all suggestions, the Computer Coordinator gave me new tasks:
- Be able to mark/filter suggestions as read/unread  
- Be able to mark suggestions as resolved/unresolved  
- Allow the leadership to add comments that the other leaders can view  
- If not anonymous, allow the leadership to send a notification to the suggestor  

And thus, I basically created Facebook, but for Cal Band leadership... I suggested that we could also add "reacts" to the suggestions, but that was quickly swatted down.

![Suggestion Box Screenshot]({{ site.url }}/images/compcomm2.png)

I ended up having to write my own Sass and jQuery files to make the interface better for the leadership. The comments were the most difficult to implement. There were multiple suggestions, so I had to make sure that each form would be connected with its individual suggestion. In the HTML, I added a field for `data-pk`, and made the submit button value equal to the pk, which allowed me to figure out the private key of the suggestion that the form was connected to. Also, for each suggestion, there were two buttons, one for "Add Comment," and another for "Send Notification to Sender." To distinguish between the two submit buttons, I added a `name` field that could be picked up in the Django code. Here is what my submit buttons ended up looking like:
{% raw %}
`<button type="submit" class="add-comment" name="add_comment" value="{{ suggestion.pk }}">Add Comment</button>`
{% endraw %}
Thus, in my Django View code, I could pick up the `name` and `value` of the button that was clicked:
```
def form_valid(self, form):
    comment = form.save(commit=False)
    comment.rosterentry = self.request.user.rosterentry

    # Check if submit button clicked was notify_sender or add_comment
    if 'notify_sender' in form.data:
        pk = form.data['notify_sender']
        comment.suggestion = SuggestionBoxEntry.objects.get(pk=pk)
        notification = NotificationItem.objects.create_and_email(
            receiver=comment.suggestion.sender,
            subject=f'Response to Suggestion: {comment.suggestion.subject}',
            message=comment.comment,
            sender_roster = comment.rosterentry,
        )
        comment.comment = f'[SENT NOTIFICATION TO SENDER]: {comment.comment}'
    elif 'add_comment' in form.data:
        pk = form.data['add_comment']
        comment.suggestion = SuggestionBoxEntry.objects.get(pk=pk)
    ...
```
I was very excited when this worked! In the future, I'm hoping to improve the interface even futher. When adding a comment, it forces the browser to refresh in order to see the changes. I don't want this, and want to use AJAX so that the experience is not interrupted every time a comment is added.

# Final Thoughts
The Computer Committee turned out to be much more educational than I originally thought it would be. I felt that I learned both web dev and good software practices. This was the first time that I used Sass and jQuery, as well as the first time that I interacted with a large Django codebase. The committee makes sure that all pull requests go through a code review and a style check. I'm also grateful that I was able to learn alongside my fellow Cal Bandsmen! I hope to continue contributing to this group and improve the web services to Cal Band!